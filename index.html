<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>ë‘ì«€ì¿ íŒ… ì‹ ì²­</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
      padding-bottom: 100px;
    }

    .header {
      background: white;
      padding: 20px;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .header h1 { 
      font-size: 24px; 
      font-weight: 700; 
      color: #333;
      margin-bottom: 8px;
    }

    .header p { 
      font-size: 14px; 
      color: #666;
    }

    .progress-bar {
      width: 100%;
      height: 4px;
      background: #e0e0e0;
      margin-top: 15px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #0b84ff, #00d4ff);
      width: 0%;
      transition: width 0.3s ease;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }

    .welcome-section {
      background: white;
      border-radius: 16px;
      padding: 30px 25px;
      padding-bottom: 100px;
      margin-bottom: 20px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }

    .welcome-section h2 {
      font-size: 20px;
      font-weight: 700;
      color: #333;
      margin-bottom: 20px;
      text-align: center;
    }

    .notice-content {
      font-size: 14px;
      line-height: 1.7;
      color: #555;
    }

    .notice-content strong {
      display: block;
      color: #333;
      font-weight: 600;
      margin-top: 20px;
      margin-bottom: 10px;
      font-size: 15px;
    }

    .notice-content ul {
      margin-left: 20px;
      margin-top: 8px;
    }

    .notice-content li {
      margin-bottom: 5px;
    }

    .notice-divider {
      width: 100%;
      height: 1px;
      background: #e0e0e0;
      margin: 15px 0;
    }

    .contact-link {
      color: #0b84ff;
      text-decoration: none;
      font-weight: 500;
    }

    .form-section {
      background: white;
      border-radius: 16px;
      padding: 30px 25px;
      margin-bottom: 20px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      display: none;
    }

    .form-section.active {
      display: block;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-group label {
      display: block;
      font-size: 15px;
      font-weight: 600;
      color: #333;
      margin-bottom: 10px;
    }

    .form-group .required {
      color: #ff3b30;
      margin-left: 4px;
    }

    .form-group .step-info {
      font-size: 12px;
      color: #999;
      font-weight: 400;
      margin-left: 6px;
    }

    .form-group input[type="text"],
    .form-group textarea {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 14px;
      transition: all 0.2s;
      font-family: inherit;
    }

    .form-group input[type="text"]:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #0b84ff;
      box-shadow: 0 0 0 3px rgba(11, 132, 255, 0.1);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
    }

    .option-btn {
      padding: 12px 16px;
      border: 2px solid #ddd;
      background: white;
      border-radius: 10px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
      text-align: center;
    }

    .option-btn:hover {
      border-color: #0b84ff;
      background: #f0f8ff;
    }

    .option-btn.selected {
      border-color: #0b84ff;
      background: #0b84ff;
      color: white;
      font-weight: 600;
    }

    .image-upload-area {
      border: 2px dashed #ddd;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .image-upload-area:hover {
      border-color: #0b84ff;
      background: #f0f8ff;
    }

    .image-upload-area.has-images {
      border-style: solid;
      border-color: #0b84ff;
      background: #f0f8ff;
    }

    .upload-icon {
      font-size: 40px;
      margin-bottom: 10px;
    }

    .upload-text {
      font-size: 14px;
      color: #666;
    }

    .image-preview-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 20px;
    }

    .image-preview-wrapper {
      position: relative;
    }

    .image-preview {
      width: 100%;
      aspect-ratio: 1;
      object-fit: cover;
      border-radius: 12px;
      border: 2px solid #0b84ff;
    }

    .remove-image {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ff3b30;
      color: white;
      border: none;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .checkbox-wrapper {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 15px;
      background: #f8f8f8;
      border-radius: 10px;
    }

    .checkbox-wrapper input[type="checkbox"] {
      width: 22px;
      height: 22px;
      cursor: pointer;
      margin-top: 2px;
      flex-shrink: 0;
    }

    .checkbox-wrapper label {
      font-size: 13px;
      line-height: 1.5;
      margin: 0;
      font-weight: 400;
      color: #333;
    }

    .submit-button {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #0b84ff, #00d4ff);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 30px;
      box-shadow: 0 4px 16px rgba(11, 132, 255, 0.4);
      transition: all 0.3s;
    }

    .submit-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(11, 132, 255, 0.5);
    }

    .submit-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .start-button {
      width: calc(100% - 40px);
      max-width: 560px;
      padding: 16px;
      background: linear-gradient(135deg, #0b84ff, #00d4ff);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(11, 132, 255, 0.4);
      transition: all 0.3s;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
    }

    .start-button:hover {
      transform: translateX(-50%) translateY(-2px);
      box-shadow: 0 6px 20px rgba(11, 132, 255, 0.5);
    }

    .error-message {
      color: #ff3b30;
      font-size: 13px;
      margin-top: 8px;
      display: none;
    }

    .error-message.show {
      display: block;
    }

    .success-message {
      background: white;
      border-radius: 16px;
      padding: 40px 30px;
      text-align: center;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }

    .success-message h2 {
      font-size: 24px;
      color: #333;
      margin-bottom: 15px;
    }

    .success-message p {
      font-size: 15px;
      color: #666;
      line-height: 1.6;
    }

    .success-icon {
      font-size: 60px;
      margin-bottom: 20px;
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      .welcome-section,
      .form-section {
        padding: 25px 20px;
      }

      .header h1 {
        font-size: 20px;
      }

      .options-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>

<body>
  <div class="header">
    <h1>ğŸ’š ë‘ì«€ì¿ íŒ…</h1>
    <p>ì°¸ì—¬ì ëª¨ì§‘ ì‹ ì²­ì„œ</p>
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>
  </div>

  <div class="container">
    <!-- ê³µì§€ì‚¬í•­ ì„¹ì…˜ -->
    <div class="welcome-section" id="welcomeSection">
      <h2>[ë‘ì«€ì¿ íŒ… : ë‘ì«€ì¿  ë§Œë“¤ë©´ì„œ ì†Œê°œíŒ…]</h2>
      <div class="notice-content">
        ë”±ë”±í•˜ê³  ê° ì¡íŒ ì†Œê°œíŒ… ë§ê³ <br>
        ë‘ì«€ì¿ íŒ… ì–´ë•Œìš”?<br><br>
        ì˜ˆìœ ì¹´í˜ì— í•¨ê»˜ ëª¨ì—¬<br>
        ë‘ì«€ì¿ ë¥¼ ê°™ì´ ë§Œë“¤ë‹¤ ë³´ë©´,<br>
        ì–´ëŠìƒˆ ë§ˆìŒì´ ì—´ë¦¬ê³  ì„œë¡œ ê°€ê¹Œì›Œì§ˆ ê±°ì˜ˆìš”.
        
        <div class="notice-divider"></div>

        <strong>ğŸ’Œ ë‘ì«€ì¿ íŒ…ì€ ì´ë ‡ê²Œ ì§„í–‰ë¼ìš”</strong>
        <strong>1ë¶€ : ë‘ì«€ì¿  ë§Œë“¤ê¸°</strong>
        ì‚¬ì „ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ í…Œì´ë¸” ë°°ì¹˜ë¡œ<br>
        ì´ìƒí˜•ê³¼ í•¨ê»˜ ë‘ì«€ì¿ ë¥¼ ë§Œë“­ë‹ˆë‹¤.

        <strong>2ë¶€ : ë‘ì«€ì¿  ê¾¸ë¯¸ê¸° & ë¡œí…Œì´ì…˜ íƒ€ì„</strong>
        ê°€ì¥ ë§ˆìŒì— ë“œëŠ” ì´ì„±ì—ê²Œ ì„ ë¬¼í•  ë‘ì«€ì¿ ë¥¼ ê¾¸ë°‰ë‹ˆë‹¤.<br>
        ë™ì‹œì— ë¡œí…Œì´ì…˜ íƒ€ì„ì„ ê°€ì§€ë©° ì—¬ëŸ¬ ì‚¬ëŒë“¤ê³¼ ëŒ€í™”í•©ë‹ˆë‹¤.
        
        <div class="notice-divider"></div>
        
        <strong>ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ ëª¨ì§‘ ì¸ì›ìˆ˜</strong>
        ì´ 16ëª… ëª¨ì§‘(ë‚¨,ë…€ ê°ê° 8ëª…)
        
        <div class="notice-divider"></div>
        
        <strong>ğŸ“ ê¸ˆì•¡</strong>
        49,000ì›<br>
        <span style="font-size: 13px; color: #666;">(ê³„ì¢ŒëŠ” í™•ì •ëœ ë¶„ë“¤ì— í•œí•´ ë¬¸ìë¡œ ê°œë³„ ì•ˆë‚´)</span>
        
        <div class="notice-divider"></div>
        
        <strong>ğŸ¥ ì¥ì†Œ</strong>
        <ul>
          <li>ì„œìš¸ì‹œ ì„œëŒ€ë¬¸êµ¬ í†µì¼ë¡œ</li>
          <li>ì£¼ì°¨ ë¶ˆê°€</li>
        </ul>
        <span style="font-size: 13px; color: #666;">(ìì„¸í•œ ì£¼ì†ŒëŠ” í™•ì •ëœ ë¶„ë“¤ì— í•œí•´ ë¬¸ìë¡œ ê°œë³„ ì•ˆë‚´)</span>
        
        <div class="notice-divider"></div>
        
        <strong>ğŸ‚ ì°¸ì—¬ ì¡°ê±´</strong>
        <ul>
          <li>1992ë…„ìƒ ~ 2002ë…„ìƒ</li>
          <li>ë‘ì«€ì¿ ë¥¼ ì¢‹ì•„í•˜ëŠ” ë¶„</li>
          <li>173cm ì´ìƒ(ë‚¨ì„±)</li>
        </ul>

        <div class="notice-divider"></div>
        
        <strong>ğŸ’¬ ì¶”ê°€ ë¬¸ì˜</strong>
        <a href="https://instagram.com/duzzonku_ting" class="contact-link" target="_blank">@duzzonku_ting</a>
      </div>

      <button class="start-button" onclick="startForm()">ì‹ ì²­ì„œ ì‘ì„± ì‹œì‘í•˜ê¸°</button>
    </div>

    <!-- í¼ ì„¹ì…˜ -->
    <div class="form-section" id="formSection">
      <form id="applicationForm">
        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div class="form-group">
          <label>ì´ë¦„<span class="required">*</span><span class="step-info">(1/13)</span></label>
          <input type="text" name="name" required placeholder="í™ê¸¸ë™">
          <div class="error-message">ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ë³„ëª…<span class="required">*</span><span class="step-info">(2/13)</span></label>
          <input type="text" name="nickname" required placeholder="ì†Œê°œíŒ…ì—ì„œ ì‚¬ìš©í•  ë³„ëª…">
          <div class="error-message">ë³„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ì„±ë³„<span class="required">*</span><span class="step-info">(3/13)</span></label>
          <div class="options-grid">
            <div class="option-btn" data-name="gender" data-value="ë‚¨ì„±">ë‚¨ì„±</div>
            <div class="option-btn" data-name="gender" data-value="ì—¬ì„±">ì—¬ì„±</div>
          </div>
          <input type="hidden" name="gender" required>
          <div class="error-message">ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ë‚˜ì´<span class="required">*</span><span class="step-info">(4/13)</span></label>
          <input type="text" name="age" required placeholder="ì˜ˆ: 2000ë…„ìƒ">
          <div class="error-message">ë‚˜ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>í‚¤<span class="required">*</span><span class="step-info">(5/13)</span></label>
          <input type="text" name="height" required placeholder="ì˜ˆ: 175cm">
          <div class="error-message">í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ì—°ë½ì²˜<span class="required">*</span><span class="step-info">(6/13)</span></label>
          <input type="text" name="phone" required placeholder="010-1234-5678">
          <div class="error-message">ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ì§ì—…<span class="required">*</span><span class="step-info">(7/13)</span></label>
          <input type="text" name="job" required placeholder="ì˜ˆ: íšŒì‚¬ì›, ëŒ€í•™ìƒ">
          <div class="error-message">ì§ì—…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>MBTI<span class="required">*</span><span class="step-info">(8/13)</span></label>
          <div class="options-grid">
            <div class="option-btn" data-name="mbti" data-value="ISTJ">ISTJ</div>
            <div class="option-btn" data-name="mbti" data-value="ISFJ">ISFJ</div>
            <div class="option-btn" data-name="mbti" data-value="INFJ">INFJ</div>
            <div class="option-btn" data-name="mbti" data-value="INTJ">INTJ</div>
            <div class="option-btn" data-name="mbti" data-value="ISTP">ISTP</div>
            <div class="option-btn" data-name="mbti" data-value="ISFP">ISFP</div>
            <div class="option-btn" data-name="mbti" data-value="INFP">INFP</div>
            <div class="option-btn" data-name="mbti" data-value="INTP">INTP</div>
            <div class="option-btn" data-name="mbti" data-value="ESTP">ESTP</div>
            <div class="option-btn" data-name="mbti" data-value="ESFP">ESFP</div>
            <div class="option-btn" data-name="mbti" data-value="ENFP">ENFP</div>
            <div class="option-btn" data-name="mbti" data-value="ENTP">ENTP</div>
            <div class="option-btn" data-name="mbti" data-value="ESTJ">ESTJ</div>
            <div class="option-btn" data-name="mbti" data-value="ESFJ">ESFJ</div>
            <div class="option-btn" data-name="mbti" data-value="ENFJ">ENFJ</div>
            <div class="option-btn" data-name="mbti" data-value="ENTJ">ENTJ</div>
            <div class="option-btn" data-name="mbti" data-value="ëª¨ë¦„">ëª¨ë¦„</div>
          </div>
          <input type="hidden" name="mbti" required>
          <div class="error-message">MBTIë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ì´ìƒí˜•<span class="required">*</span><span class="step-info">(9/13)</span></label>
          <textarea name="ideal_type" required placeholder="ì´ìƒí˜•ì„ ê°„ë‹¨íˆ ì„¤ëª…í•´ì£¼ì„¸ìš” ğŸ’•"></textarea>
          <div class="error-message">ì´ìƒí˜•ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ìê¸°ì†Œê°œ<span class="step-info">(10/13) - ì„ íƒì‚¬í•­</span></label>
          <textarea name="self_intro" placeholder="ë³¸ì¸ì„ ë‚˜íƒ€ë‚´ëŠ” í•œë§ˆë””! ìŠ¤í‚µí•˜ì…”ë„ ê´œì°®ìŠµë‹ˆë‹¤ ğŸ¤©"></textarea>
        </div>

        <div class="form-group">
          <label>ì‚¬ì§„<span class="required">*</span><span class="step-info">(11/13)</span></label>
          <p style="font-size: 13px; color: #666; margin-bottom: 12px;">
            ëª¨ë‘ê°€ ì¦ê±°ìš´ ì†Œì…œë§ì„ ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ì§„ ë‘ ì¥ì„ ë°›ê³  ìˆìŠµë‹ˆë‹¤.<br>
            ì™¸ëª¨ ë° ì‹ ì› í™•ì¸ì„ ìœ„í•œ ê³¼ì •ì´ë‹ˆ ì–‘í•´ ë¶€íƒë“œë ¤ìš”!<br>
            ë‚¨ë…€ ë˜‘ê°™ì´ í™•ì¸í•˜ê³  ìˆë‹µë‹ˆë‹¤ ã…ã…
          </p>
          <div class="image-upload-area" id="imageUploadArea" onclick="document.getElementById('photoInput').click()">
            <div class="upload-icon">ğŸ“·</div>
            <div class="upload-text">ì‚¬ì§„ 2ì¥ ì„ íƒí•˜ê¸°</div>
          </div>
          <input type="file" id="photoInput" accept="image/*" multiple style="display:none;">
          <div class="image-preview-container" id="imagePreviewContainer"></div>
          <input type="hidden" name="photo1" required>
          <input type="hidden" name="photo2" required>
          <div class="error-message">ì‚¬ì§„ 2ì¥ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ìŒë£Œ ì„ í˜¸<span class="required">*</span><span class="step-info">(12/13)</span></label>
          <p style="font-size: 13px; color: #666; margin-bottom: 12px;">
            ê°„ë‹¨í•œ ìŒë£Œë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤ â˜•
          </p>
          <div class="options-grid">
            <div class="option-btn" data-name="beverage" data-value="ì»¤í”¼">ì»¤í”¼</div>
            <div class="option-btn" data-name="beverage" data-value="ì•„ì´ìŠ¤í‹°">ì•„ì´ìŠ¤í‹°</div>
          </div>
          <input type="hidden" name="beverage" required>
          <div class="error-message">ìŒë£Œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ê²¬ê³¼ë¥˜ ì•ŒëŸ¬ì§€<span class="required">*</span><span class="step-info">(13/13)</span></label>
          <div class="options-grid">
            <div class="option-btn" data-name="allergy" data-value="ìˆìŒ">ìˆìŒ</div>
            <div class="option-btn" data-name="allergy" data-value="ì—†ìŒ">ì—†ìŒ</div>
          </div>
          <input type="hidden" name="allergy" required>
          <div class="error-message">ì•ŒëŸ¬ì§€ ì—¬ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="form-group">
          <label>ì´¬ì˜ ë™ì˜<span class="required">*</span></label>
          <div class="checkbox-wrapper">
            <input type="checkbox" id="videoConsent" name="video" required>
            <label for="videoConsent">
              í›„ê¸° ì½˜í…ì¸  ì œì‘ì„ ìœ„í•´ ì§„í–‰ì— ë°©í•´ë˜ì§€ ì•ŠëŠ” ì„ ì—ì„œ ì´¬ì˜ì´ ìˆì„ ì˜ˆì •ì…ë‹ˆë‹¤.
              ì–¼êµ´ì€ ì „ì²´ ëª¨ìì´í¬ ì²˜ë¦¬ë  ì˜ˆì •ì´ë©° ì´ì™¸ì˜ ëª©ì ì—ëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            </label>
          </div>
          <div class="error-message">ì´¬ì˜ ë™ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤</div>
        </div>

        <div class="form-group">
          <label>ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜<span class="required">*</span></label>
          <div class="checkbox-wrapper">
            <input type="checkbox" id="privacyConsent" name="privacy" required>
            <label for="privacyConsent">
              ì„œë¹„ìŠ¤ ì œê³µ(ëª©ì )ì„ ìœ„í•´ ìƒê¸° ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ë©°, ìˆ˜ì§‘ëœ ì •ë³´ëŠ” í–‰ì‚¬ ìš´ì˜ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ë©° í–‰ì‚¬ ì¢…ë£Œ í›„ ìë™ íŒŒê¸°ë©ë‹ˆë‹¤.
            </label>
          </div>
          <div class="error-message">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤</div>
        </div>

        <div class="form-group">
          <label>ì°¸ì„ ê°€ëŠ¥í•œ ë‚ ì§œ<span class="required">*</span></label>
          <div class="options-grid" style="grid-template-columns: 1fr;">
            <div class="option-btn" data-name="event_date" data-value="2/22 (ì¼) 15:30~17:30">2/22 (ì¼) 15:30~17:30</div>
            <div class="option-btn" data-name="event_date" data-value="3/1 (ì¼) 15:30~17:30">3/1 (ì¼) 15:30~17:30</div>
            <div class="option-btn" data-name="event_date" data-value="3/8 (ì¼) 15:30~17:30">3/8 (ì¼) 15:30~17:30</div>
          </div>
          <input type="hidden" name="event_date" required>
          <div class="error-message">ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
        </div>

        <button type="submit" class="submit-button">ì‹ ì²­ ì™„ë£Œí•˜ê¸° ğŸ‰</button>
      </form>
    </div>

    <!-- ì™„ë£Œ ë©”ì‹œì§€ -->
    <div class="form-section" id="successSection">
      <div class="success-message">
        <div class="success-icon">ğŸ‰</div>
        <h2>ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</h2>
        <p>
          ì†Œì¤‘í•œ ì‹œê°„ ë‚´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.<br>
          í™•ì • ì•ˆë‚´ëŠ” ê°œë³„ ë¬¸ìë¡œ ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.<br><br>
          ë‘ì«€ì¿ íŒ…ì—ì„œ ëµ™ê² ìŠµë‹ˆë‹¤! ğŸ’š
        </p>
      </div>
    </div>
  </div>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbwTM7zqLZCbGjpoNOwdia7Z_-VHvCYZYO9_idHuIFMyCJGwu3jB-GmJD4TV9leD3HheQA/exec";

    let uploadedImages = [];
    let sessionId = Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    let currentQuestionIndex = 0; // í˜„ì¬ ì§ˆë¬¸ ì¸ë±ìŠ¤ ì¶”ì 
    
    // ì§ˆë¬¸ ì •ë³´ (íŠ¸ë˜í‚¹ìš©)
    const questionSteps = [
      { id: 'name', label: 'ì´ë¦„' },
      { id: 'nickname', label: 'ë³„ëª…' },
      { id: 'gender', label: 'ì„±ë³„' },
      { id: 'age', label: 'ë‚˜ì´' },
      { id: 'height', label: 'í‚¤' },
      { id: 'phone', label: 'ì—°ë½ì²˜' },
      { id: 'job', label: 'ì§ì—…' },
      { id: 'mbti', label: 'MBTI' },
      { id: 'ideal_type', label: 'ì´ìƒí˜•' },
      { id: 'self_intro', label: 'ìê¸°ì†Œê°œ' },
      { id: 'photos', label: 'ì‚¬ì§„' },
      { id: 'beverage', label: 'ìŒë£Œì„ í˜¸' },
      { id: 'allergy', label: 'ì•ŒëŸ¬ì§€' },
      { id: 'video', label: 'ì´¬ì˜ë™ì˜' },
      { id: 'privacy', label: 'ê°œì¸ì •ë³´ë™ì˜' },
      { id: 'event_date', label: 'ì°¸ì„ë‚ ì§œ' }
    ];
    
    let trackingData = {
      sessionId: sessionId,
      startTime: new Date().toISOString(),
      events: [],
      maxScrollDepth: 0,
      lastActiveStep: 0,
      lastStepName: '',
      userAgent: navigator.userAgent,
      screenSize: `${window.screen.width}x${window.screen.height}`,
      viewport: `${window.innerWidth}x${window.innerHeight}`
    };

    // íŠ¸ë˜í‚¹ ì´ë²¤íŠ¸ ê¸°ë¡
    function trackEvent(eventType, data = {}) {
      const event = {
        timestamp: new Date().toISOString(),
        type: eventType,
        ...data
      };
      trackingData.events.push(event);
      
      // ë§ˆì§€ë§‰ í™œì„± ë‹¨ê³„ ì—…ë°ì´íŠ¸
      if (data.field) {
        const stepIndex = questionSteps.findIndex(q => q.id === data.field);
        if (stepIndex >= 0) {
          trackingData.lastActiveStep = stepIndex + 1;
          trackingData.lastStepName = questionSteps[stepIndex].label;
        }
      }
      
      localStorage.setItem('trackingData_' + sessionId, JSON.stringify(trackingData));
    }

    function sendTrackingData() {
      try {
        trackingData.endTime = new Date().toISOString();
        
        // ì™„ë£Œìœ¨ ê³„ì‚° (ì´ 16ê°œ í•„ìˆ˜ í•­ëª©)
        const form = document.getElementById('applicationForm');
        if (form) {
          const totalFields = form.querySelectorAll('[required]').length;
          let filledFields = 0;
          
          form.querySelectorAll('[required]').forEach(field => {
            if (field.type === 'checkbox') {
              if (field.checked) filledFields++;
            } else if (field.value.trim() !== '') {
              filledFields++;
            }
          });
          
          trackingData.completionRate = Math.round((filledFields / totalFields) * 100) + '%';
        }
        
        const dataToSend = JSON.stringify(trackingData);
        const blob = new Blob([dataToSend], { type: 'text/plain;charset=utf-8' });
        
        if (navigator.sendBeacon) {
          navigator.sendBeacon(GAS_URL + '?action=tracking', blob);
        }
      } catch (error) {}
    }

    // í˜ì´ì§€ ë¡œë“œ
    trackEvent('page_load');
    window.addEventListener('beforeunload', sendTrackingData);

    // í¼ ì‹œì‘
    function startForm() {
      trackEvent('start_button_click');
      document.getElementById('welcomeSection').style.display = 'none';
      document.getElementById('formSection').classList.add('active');
      updateProgress();
      window.scrollTo(0, 0);
    }

    // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
    function updateProgress() {
      const form = document.getElementById('applicationForm');
      const totalFields = form.querySelectorAll('[required]').length;
      let filledFields = 0;

      form.querySelectorAll('[required]').forEach(field => {
        if (field.type === 'checkbox') {
          if (field.checked) filledFields++;
        } else if (field.value.trim() !== '') {
          filledFields++;
        }
      });

      const progress = (filledFields / totalFields) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    // ì˜µì…˜ ë²„íŠ¼ í´ë¦­
    document.querySelectorAll('.option-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const name = this.dataset.name;
        const value = this.dataset.value;
        
        // ê°™ì€ ê·¸ë£¹ì˜ ë‹¤ë¥¸ ë²„íŠ¼ ì„ íƒ í•´ì œ
        document.querySelectorAll(`.option-btn[data-name="${name}"]`).forEach(b => {
          b.classList.remove('selected');
        });
        
        // í˜„ì¬ ë²„íŠ¼ ì„ íƒ
        this.classList.add('selected');
        
        // hidden inputì— ê°’ ì„¤ì •
        document.querySelector(`input[name="${name}"]`).value = value;
        
        trackEvent('option_selected', { field: name, value: value });
        updateProgress();
      });
    });

    // ì²´í¬ë°•ìŠ¤ ë³€ê²½ ì‹œ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
      checkbox.addEventListener('change', function() {
        const fieldName = this.name === 'video' ? 'video' : 'privacy';
        trackEvent('checkbox_toggled', { field: fieldName, id: this.id, checked: this.checked });
        updateProgress();
      });
    });

    // ì´ë¯¸ì§€ ì—…ë¡œë“œ
    document.getElementById('photoInput').addEventListener('change', async (e) => {
      const files = Array.from(e.target.files);
      
      if (files.length !== 2) {
        alert('ì‚¬ì§„ì„ ì •í™•íˆ 2ì¥ ì„ íƒí•´ì£¼ì„¸ìš”.');
        e.target.value = '';
        return;
      }

      trackEvent('image_upload_started', { field: 'photos', count: files.length });

      try {
        const resizedImages = await Promise.all(
          files.map(file => fileToResizedDataUrl(file, 0.7))
        );

        uploadedImages = resizedImages;
        document.querySelector('input[name="photo1"]').value = resizedImages[0];
        document.querySelector('input[name="photo2"]').value = resizedImages[1];

        // í”„ë¦¬ë·° í‘œì‹œ
        const previewContainer = document.getElementById('imagePreviewContainer');
        previewContainer.innerHTML = '';
        
        resizedImages.forEach((imgData, index) => {
          const wrapper = document.createElement('div');
          wrapper.className = 'image-preview-wrapper';
          
          const img = document.createElement('img');
          img.src = imgData;
          img.className = 'image-preview';
          
          const removeBtn = document.createElement('button');
          removeBtn.className = 'remove-image';
          removeBtn.innerHTML = 'Ã—';
          removeBtn.onclick = (e) => {
            e.stopPropagation();
            removeImage(index);
          };
          
          wrapper.appendChild(img);
          wrapper.appendChild(removeBtn);
          previewContainer.appendChild(wrapper);
        });

        document.getElementById('imageUploadArea').classList.add('has-images');
        trackEvent('image_upload_success', { field: 'photos' });
        updateProgress();

      } catch (err) {
        console.error(err);
        alert('ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        trackEvent('image_upload_error', { field: 'photos' });
      }
    });

    function removeImage(index) {
      uploadedImages = [];
      document.querySelector('input[name="photo1"]').value = '';
      document.querySelector('input[name="photo2"]').value = '';
      document.getElementById('imagePreviewContainer').innerHTML = '';
      document.getElementById('imageUploadArea').classList.remove('has-images');
      document.getElementById('photoInput').value = '';
      trackEvent('image_removed', { field: 'photos' });
      updateProgress();
    }

    function fileToResizedDataUrl(file, quality = 0.7) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
          const img = new Image();
          img.onload = () => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');

            const maxWidth = 800;
            const maxHeight = 800;
            let width = img.width;
            let height = img.height;

            if (width > height) {
              if (width > maxWidth) { height *= maxWidth / width; width = maxWidth; }
            } else {
              if (height > maxHeight) { width *= maxHeight / height; height = maxHeight; }
            }

            canvas.width = width;
            canvas.height = height;
            ctx.drawImage(img, 0, 0, width, height);

            resolve(canvas.toDataURL('image/jpeg', quality));
          };
          img.onerror = reject;
          img.src = reader.result;
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    // ì…ë ¥ í•„ë“œ ë³€ê²½ ê°ì§€
    document.querySelectorAll('input[type="text"], textarea').forEach(input => {
      input.addEventListener('input', function() {
        updateProgress();
      });
      
      // ì…ë ¥ ì™„ë£Œ ì‹œ íŠ¸ë˜í‚¹ (í¬ì»¤ìŠ¤ ì•„ì›ƒ)
      input.addEventListener('blur', function() {
        if (this.value.trim() !== '') {
          trackEvent('field_completed', { 
            field: this.name, 
            hasValue: true,
            length: this.value.length 
          });
        }
      });
    });

    // ì¤‘ë³µ ì œì¶œ ë°©ì§€ í”Œë˜ê·¸
    let isSubmitting = false;

    // í¼ ì œì¶œ
    document.getElementById('applicationForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const form = e.target;
      const submitButton = form.querySelector('.submit-button');
      
      // ì´ë¯¸ ì œì¶œ ì¤‘ì´ë©´ ë¬´ì‹œ
      if (isSubmitting) {
        return;
      }
      
      // ìœ íš¨ì„± ê²€ì‚¬
      let isValid = true;
      
      form.querySelectorAll('[required]').forEach(field => {
        const errorMsg = field.parentElement.querySelector('.error-message');
        
        if (field.type === 'checkbox') {
          if (!field.checked) {
            isValid = false;
            if (errorMsg) errorMsg.classList.add('show');
          } else {
            if (errorMsg) errorMsg.classList.remove('show');
          }
        } else if (field.value.trim() === '') {
          isValid = false;
          if (errorMsg) errorMsg.classList.add('show');
          field.style.borderColor = '#ff3b30';
        } else {
          if (errorMsg) errorMsg.classList.remove('show');
          field.style.borderColor = '#ddd';
        }
      });

      if (!isValid) {
        alert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        // ì²« ë²ˆì§¸ ì—ëŸ¬ë¡œ ìŠ¤í¬ë¡¤
        const firstError = form.querySelector('.error-message.show');
        if (firstError) {
          firstError.parentElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        return;
      }

      // âœ¨ ì œì¶œ ì‹œì‘ - ì¦‰ì‹œ ë²„íŠ¼ ë¹„í™œì„±í™”
      isSubmitting = true;
      submitButton.disabled = true;
      submitButton.style.opacity = '0.6';
      submitButton.innerHTML = 'ì œì¶œ ì¤‘... â³';
      
      trackEvent('form_submit_attempt');

      // í¼ ë°ì´í„° ìˆ˜ì§‘
      const formData = new FormData(form);
      const data = {
        id: Date.now(),
        timestamp: new Date().toISOString(),
        date: new Date().toLocaleDateString('ko-KR'),
        time: new Date().toLocaleTimeString('ko-KR'),
        sessionId: sessionId
      };

      formData.forEach((value, key) => {
        data[key] = value;
      });

      try {
        const res = await fetch(GAS_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(data)
        });

        let out = { ok: true };
        try {
          out = await res.json();
        } catch (e) {}

        if (!res.ok || out.ok === false) {
          throw new Error(out.error || `HTTP ${res.status}`);
        }

        trackEvent('submission_success');
        sendTrackingData();

        // ì„±ê³µ í™”ë©´ í‘œì‹œ
        document.getElementById('formSection').classList.remove('active');
        document.getElementById('successSection').classList.add('active');
        window.scrollTo(0, 0);

      } catch (error) {
        console.error("ì €ì¥ ì˜¤ë¥˜:", error);
        trackEvent('submission_error', { error: error.message });
        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
        
        // ì—ëŸ¬ ì‹œ ë²„íŠ¼ ë³µêµ¬
        isSubmitting = false;
        submitButton.disabled = false;
        submitButton.style.opacity = '1';
        submitButton.innerHTML = 'ì‹ ì²­ ì™„ë£Œí•˜ê¸° ğŸ‰';
      }
    });
  </script>
</body>
</html>
